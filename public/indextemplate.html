<!doctype html>
<html>
  <head>
    <title>WebSocket echo test</title>
    <script src="scripts/game.js"></script>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <script>  
      var open = false
        , lastMessage;

      window.onload = function () {
        // create socket
        var ws = new WebSocket('ws://localhost:3000');
        ws.onopen = function () {
          open = true;
          ws.gameName = 'The Game';
          ws.send( ws.gameName );
        };
        ws.onmessage = function ( env ) {
        	if( env.data == ws.gameName ){
        		ws.send( ws.gameName );
        	} else {
        		document.getElementById('data').innerHTML = env.data;
        	}
          	
        };

		// attach listeners to login form
        document.getElementById('menueLogin').onclick = function () {
          document.getElementById('login').style.visibility='visible';
        };
        
        document.getElementById('loginCancel').onclick = function () {
          document.getElementById('loginUsername').value='';
          document.getElementById('loginPassword').value='';
          document.getElementById('login').style.visibility='hidden';
        };
        
        document.getElementById('loginForm').onsubmit = function (){
	      var usr = document.getElementById('loginUsername').value;
		  var pw = document.getElementById('loginPassword').value;
		  alert("Login als " + usr + "\nPasswort: " + pw );
		  document.getElementById('login').style.visibility='hidden';
        };
        
      };
    </script>
  </head>
  <body>
  	<div id="wrapper">
        <div id="headerwrap">
	        <div id="header">
	            <span class="mrTitle">Mixed Reality Web Graphics</span>
	        </div>
        </div>
        <div id="navigationwrap">
	        <div id="navigation">
	        	<!-- MENUE START -->
	            <span class="button menueItemActive" id="menueGames">Games</span>
	            <span class="button" id="menueAdmin">Admin</span>
	            <span class="menueSeperator"> </span>
	            <span class="button" id="menueLogin">Login</span>
	            <!-- MENUE END -->
	        </div>
        </div>
        <div id="contentwrap">
	        <div id="content">
	        	<!-- CONTENT BEGIN -->
	        	<div class="list", id="gameControl">
        			<span class="listEntry">
        				<span class="listEntryElement gameInfoHeader" id="gameInfoHeader">Maus 03 : 01 Elefant<span>Time: 05:47</span></span>
        				<span class="button" id="gameStartStop">Start</span>
        				<span class="button" id="gameRequestTimeout">Timeout</span>
        			</span>
        		</div>
	        	<canvas class="game" id="game"></canvas>
	        	<div class="list" id="gameInfo">
	        		Game is running ...
	        	</div>
	        	
	        	<script>
	        	
	        		// call canvas update function
	        		updateCanvas();	
	        		
			  	</script>
	        	
	        	
	        	<form class="list" id="newGameForm">         		       		
	        		<span class="listEntry">
	        			<span class="listEntryElement">
	        				Gamename: <input type="text" value="NewGame" size="16" id="newConnectionGamename" />
	        				IP: <input type="text" value="127.0.0.1" size="12" id="newConnectionIP" />
	        				Port: <input type="text" id="newConnectionPort" value="9060" size="3" />
	        			</span>
	        			<span class="button"><input type="submit" class="button" id="newGameConnect" value="New Game" /></span>
	        		</span>        		
	        	</form>
	        	
	        	<div class="list", id="gameList">
		        	<span class="listEntry" id="game1">
		        		<span class="listEntryElement">Game 1: Maus vs. Elefant<br /><i>Status: playing</i></span>
		        		<span class="button">Join</span>
		        	</span>
		        	<span class="listEntry" id="game2">
		        		<span class="listEntryElement">Game 2: Pe vs. Nis<br /><i>Status: kickoff</i></span>
		        		<span class="button">Join</span>
		        	</span>
		        	<span class="listEntry" id="game3">
		        		<span class="listEntryElement">Game 2: Pe vs. Nis<br /><i>Status: kickoff</i></span>
		        		<span class="button">Join</span>
		        	</span>
		        	<span class="listEntry" id="game4">
		        		<span class="listEntryElement">Game 2: Pe vs. Nis<br /><i>Status: kickoff</i></span>
		        		<span class="button">Join</span>
		        	</span>
	        	</div>
	        	<!-- CONTENT END -->
	        </div>
        </div>
        <div id="footerwrap">
	        <div id="footer">
	            <span id="mr-subtitle">&copy;2013 by <a href="http://www.northern-stars.de">NorthernStars</a></span>
	        </div>
        </div>
    </div>
    
    <div class="overlay" id="login">
	    <div class="overlayWrapper">
	    	<form class="overlayForm" id="loginForm">	    	
	    		<div class="overlayCancel" id="loginCancel">X</div>
	    		<div class="overlayRow">
	    			<div class="overlayFormEntry">Username:</div>
	    		</div>
	    		<div class="overlayRow">
	    			<div class="overlayFormEntry"><input type="text" class="textInput" id="loginUsername" /></div>
	    		</div>
	    		<div class="overlayRow">
	    			<div class="overlayFormEntry">Password:</div>
	    		</div>
	    		<div class="overlayRow">
	    			<div class="overlayFormEntry"><input type="password" class="textInput" id="loginPassword" /></div>
	    		</div>
	    		<div class="overlayRow"><div class="overlayFormEntry"> </div></div>
	    		<div class="overlayRow">
	    			<input type="submit" class="button" id="loginSubmit" value="Login" />
	    		</div>	    		
	    	</form>
	    </div>
	</div>
	
  </body>
</html>
